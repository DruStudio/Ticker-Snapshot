<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>BlockState</title>

<style>
:root {
  --bg:#0b0c10;
  --card:#131420;
  --muted:#8a8fa3;
  --accent:#7b7cff;
  --green:#22c55e;
  --red:#ef4444;
  --border:#23243a;
}

* { box-sizing:border-box; }
body {
  margin:0;
  font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Inter,sans-serif;
  background:radial-gradient(circle at 50% 0%, #14162a 0%, var(--bg) 60%);
  color:#fff;
}

h1,h2,h3 { margin:0; }

button {
  font-family:inherit;
  cursor:pointer;
}

.app {
  max-width:1200px;
  margin:0 auto;
  padding:60px 20px 80px;
}

/* Top header */
.header {
  text-align:center;
  margin-bottom:50px;
}
.header h1 {
  font-size:3rem;
  color:var(--accent);
}
.header p {
  margin-top:10px;
  color:var(--muted);
}

/* Version / FAQ */
.footer-left {
  position:fixed;
  bottom:20px;
  left:20px;
  display:flex;
  gap:10px;
}
.badge {
  padding:6px 12px;
  border-radius:999px;
  background:#16182a;
  border:1px solid var(--border);
  font-size:0.75rem;
  color:#cbd0ff;
}

/* Layout */
.main {
  display:grid;
  grid-template-columns:380px 1fr;
  gap:40px;
  align-items:start;
}
@media(max-width:900px){
  .main { grid-template-columns:1fr; }
}

/* Panels */
.panel {
  background:linear-gradient(180deg,#15172a,#10111d);
  border-radius:20px;
  padding:24px;
  border:1px solid var(--border);
}

/* Generator */
.generator h3 {
  margin-bottom:14px;
}
.input {
  width:100%;
  padding:14px;
  border-radius:12px;
  border:1px solid var(--border);
  background:#0e0f1c;
  color:#fff;
  margin-bottom:12px;
}
.quick {
  display:grid;
  grid-template-columns:repeat(5,1fr);
  gap:8px;
  margin-bottom:14px;
}
.quick button {
  padding:10px;
  border-radius:10px;
  background:#17192d;
  border:1px solid var(--border);
  color:#fff;
}
.primary {
  width:100%;
  padding:14px;
  border-radius:12px;
  border:none;
  background:linear-gradient(135deg,#6f7cff,#8b5cf6);
  color:#fff;
  font-weight:700;
}

/* Trending */
.trending {
  margin-top:20px;
}
.trending h4 {
  margin-bottom:10px;
}
.trending-item {
  display:flex;
  justify-content:space-between;
  padding:10px 0;
  border-bottom:1px solid var(--border);
  cursor:pointer;
}
.trending-item span:last-child {
  color:var(--green);
}

/* Card */
.card {
  position:relative;
  background:linear-gradient(180deg,#15172a,#0f101c);
  border-radius:24px;
  padding:26px;
  border:2px solid var(--border);
  transition:transform .25s ease, box-shadow .25s ease;
}
.card.capture {
  animation:capture 0.35s ease;
}
@keyframes capture {
  0%{transform:scale(.985); box-shadow:0 0 0 rgba(0,0,0,0);}
  50%{box-shadow:0 0 40px rgba(123,124,255,.35);}
  100%{transform:scale(1);}
}

/* Card header */
.card-header {
  display:flex;
  justify-content:space-between;
  align-items:center;
}
.asset {
  display:flex;
  align-items:center;
  gap:10px;
}
.asset img {
  width:32px;
  height:32px;
  border-radius:50%;
}
.change.up { color:var(--green); }
.change.down { color:var(--red); }

/* Toggle */
.toggle {
  display:flex;
  gap:4px;
}
.toggle button {
  padding:6px 10px;
  font-size:0.75rem;
  border-radius:8px;
  background:#17192d;
  border:1px solid var(--border);
  color:#fff;
}
.toggle button.active {
  background:var(--accent);
}

/* Price */
.price {
  font-size:3rem;
  font-weight:900;
  margin:20px 0;
}

/* Stats */
.stats {
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:12px;
}
.stat {
  background:#101225;
  border-radius:12px;
  padding:12px;
  font-size:0.9rem;
}
.stat span {
  display:block;
  color:var(--muted);
  font-size:0.75rem;
}

/* Footer */
.card-footer {
  margin-top:18px;
  font-size:0.7rem;
  color:var(--muted);
  text-align:center;
}

/* Actions */
.actions {
  position:absolute;
  bottom:16px;
  right:16px;
  display:flex;
  gap:10px;
}
.actions button {
  width:36px;
  height:36px;
  border-radius:50%;
  border:none;
  background:#17192d;
  color:#fff;
}
body.exporting .actions { display:none; }
</style>
</head>

<body>

<div class="footer-left">
  <div class="badge">v7.0</div>
  <div class="badge">FAQ</div>
</div>

<div class="app">

  <div class="header">
    <h1>BlockState</h1>
    <p>Create. Capture. Share.</p>
  </div>

  <div class="main">

    <!-- CREATE -->
    <div class="panel generator">
      <h3>Create</h3>
      <input id="symbolInput" class="input" placeholder="BTC, SOL, BONK" />
      <div class="quick">
        <button onclick="loadSymbol('BTC')">BTC</button>
        <button onclick="loadSymbol('ETH')">ETH</button>
        <button onclick="loadSymbol('USDT')">USDT</button>
        <button onclick="loadSymbol('BNB')">BNB</button>
        <button onclick="loadSymbol('XRP')">XRP</button>
      </div>
      <button class="primary" onclick="generate()">Create BlockState</button>

      <div class="trending">
        <h4>Trending (24h movers)</h4>
        <div id="trending"></div>
      </div>
    </div>

    <!-- CAPTURE -->
    <div>
      <h3 style="text-align:center;margin-bottom:10px;">Capture</h3>
      <div id="cardContainer"></div>
    </div>

  </div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>

<script>
const API = "https://api.coingecko.com/api/v3";
let mode = "full";

async function fetchIcon(id){
  const res = await fetch(`${API}/coins/${id}`);
  const data = await res.json();
  const img = await fetch(data.image.small);
  const blob = await img.blob();
  return new Promise(r=>{
    const fr = new FileReader();
    fr.onload=()=>r(fr.result);
    fr.readAsDataURL(blob);
  });
}

async function generate(symbol="bitcoin"){
  const coinId = symbol.toLowerCase()==="btc"?"bitcoin":symbol.toLowerCase();
  const res = await fetch(`${API}/coins/${coinId}?localization=false&tickers=false&community_data=false&developer_data=false`);
  const c = await res.json();
  const icon = await fetchIcon(c.id);

  document.getElementById("cardContainer").innerHTML = `
    <div class="card capture" id="card">
      <div class="card-header">
        <div class="asset">
          <img src="${icon}">
          <div>
            <strong>${c.name}</strong>
            <div style="font-size:.75rem;color:var(--muted)">${c.symbol.toUpperCase()}</div>
          </div>
        </div>
        <div>
          <div class="change ${c.market_data.price_change_percentage_24h>=0?'up':'down'}">
            ${c.market_data.price_change_percentage_24h.toFixed(2)}%
          </div>
          <div class="toggle">
            <button onclick="setMode('compact')" class="${mode==='compact'?'active':''}">Compact</button>
            <button onclick="setMode('full')" class="${mode==='full'?'active':''}">Full</button>
          </div>
        </div>
      </div>

      <div class="price">$${c.market_data.current_price.usd.toLocaleString()}</div>

      <div class="stats">
        <div class="stat"><span>24h High</span>$${c.market_data.high_24h.usd.toLocaleString()}</div>
        <div class="stat"><span>24h Low</span>$${c.market_data.low_24h.usd.toLocaleString()}</div>
        <div class="stat"><span>Market Cap</span>$${(c.market_data.market_cap.usd/1e12).toFixed(2)}T</div>
        <div class="stat"><span>MC Rank</span>#${c.market_cap_rank}</div>
      </div>

      <div class="card-footer">
        Captured • ${new Date().toUTCString()}<br>BLOCKSTATE.LIVE
      </div>

      <div class="actions">
        <button onclick="exportImage()">⬇</button>
        <button onclick="share()">⤴</button>
      </div>
    </div>
  `;
}

function setMode(m){ mode=m; generate(); }

function exportImage(){
  document.body.classList.add("exporting");
  html2canvas(document.getElementById("card"),{scale:2}).then(c=>{
    const a=document.createElement("a");
    a.href=c.toDataURL();
    a.download="blockstate.png";
    a.click();
    document.body.classList.remove("exporting");
  });
}

function share(){
  if(navigator.share){
    navigator.share({title:"BlockState",url:location.href});
  }
}

async function loadTrending(){
  const res = await fetch(`${API}/coins/markets?vs_currency=usd&order=volume_desc&per_page=10&page=1`);
  const data = await res.json();
  document.getElementById("trending").innerHTML =
    data.map(c=>`<div class="trending-item" onclick="generate('${c.id}')">
      <span>${c.name}</span><span>${c.price_change_percentage_24h.toFixed(2)}%</span>
    </div>`).join("");
}

function loadSymbol(s){ generate(s); }

generate("bitcoin");
loadTrending();
setInterval(loadTrending, 20*60*1000);
</script>
</body>
</html>
